<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../../jacoco-resources/report.gif" type="image/gif"/><title>Check.java</title><link rel="stylesheet" href="../../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../../index.html" class="el_report">Dependency-Check Build-Reporting</a> &gt; <a href="../index.html" class="el_bundle">dependency-check-ant</a> &gt; <a href="index.source.html" class="el_package">org.owasp.dependencycheck.taskdefs</a> &gt; <span class="el_source">Check.java</span></div><h1>Check.java</h1><pre class="source lang-java linenums">/*
 * This file is part of dependency-check-ant.
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * Copyright (c) 2013 Jeremy Long. All Rights Reserved.
 */
package org.owasp.dependencycheck.taskdefs;

import java.io.File;
import java.util.ArrayList;
import java.util.List;
import javax.annotation.concurrent.NotThreadSafe;

import org.apache.tools.ant.BuildException;
import org.apache.tools.ant.Project;
import org.apache.tools.ant.types.EnumeratedAttribute;
import org.apache.tools.ant.types.Reference;
import org.apache.tools.ant.types.Resource;
import org.apache.tools.ant.types.ResourceCollection;
import org.apache.tools.ant.types.resources.FileProvider;
import org.apache.tools.ant.types.resources.Resources;
import org.owasp.dependencycheck.Engine;
import org.owasp.dependencycheck.data.nvdcve.DatabaseException;
import org.owasp.dependencycheck.data.update.exception.UpdateException;
import org.owasp.dependencycheck.dependency.Dependency;
import org.owasp.dependencycheck.dependency.Identifier;
import org.owasp.dependencycheck.dependency.Vulnerability;
import org.owasp.dependencycheck.exception.ExceptionCollection;
import org.owasp.dependencycheck.exception.ReportException;
import org.owasp.dependencycheck.reporting.ReportGenerator.Format;
import org.owasp.dependencycheck.utils.Settings;
import org.slf4j.impl.StaticLoggerBinder;

/**
 * An Ant task definition to execute dependency-check during an Ant build.
 *
 * @author Jeremy Long
 */
@NotThreadSafe
public class Check extends Update {

    /**
     * System specific new line character.
     */
<span class="nc" id="L56">    private static final String NEW_LINE = System.getProperty(&quot;line.separator&quot;, &quot;\n&quot;).intern();</span>
    /**
     * Whether the ruby gemspec analyzer should be enabled.
     */
    private Boolean rubygemsAnalyzerEnabled;
    /**
     * Whether or not the Node.js Analyzer is enabled.
     */
    private Boolean nodeAnalyzerEnabled;
    /**
     * Whether or not the NSP Analyzer is enabled.
     */
    private Boolean nspAnalyzerEnabled;

    /**
     * Whether or not the Ruby Bundle Audit Analyzer is enabled.
     */
    private Boolean bundleAuditAnalyzerEnabled;
    /**
     * Whether the CMake analyzer should be enabled.
     */
    private Boolean cmakeAnalyzerEnabled;
    /**
     * Whether or not the Open SSL analyzer is enabled.
     */
    private Boolean opensslAnalyzerEnabled;
    /**
     * Whether the python package analyzer should be enabled.
     */
    private Boolean pyPackageAnalyzerEnabled;
    /**
     * Whether the python distribution analyzer should be enabled.
     */
    private Boolean pyDistributionAnalyzerEnabled;
    /**
     * Whether or not the central analyzer is enabled.
     */
    private Boolean centralAnalyzerEnabled;
    /**
     * Whether or not the nexus analyzer is enabled.
     */
    private Boolean nexusAnalyzerEnabled;
    /**
     * The URL of a Nexus server's REST API end point
     * (http://domain/nexus/service/local).
     */
    private String nexusUrl;
    /**
     * Whether or not the defined proxy should be used when connecting to Nexus.
     */
    private Boolean nexusUsesProxy;
    /**
     * Additional ZIP File extensions to add analyze. This should be a
     * comma-separated list of file extensions to treat like ZIP files.
     */
    private String zipExtensions;
    /**
     * The path to Mono for .NET assembly analysis on non-windows systems.
     */
    private String pathToMono;

    /**
     * The application name for the report.
     *
     * @deprecated use projectName instead.
     */
<span class="nc" id="L122">    @Deprecated</span>
    private String applicationName = null;
    /**
     * The name of the project being analyzed.
     */
<span class="nc" id="L127">    private String projectName = &quot;dependency-check&quot;;</span>
    /**
     * Specifies the destination directory for the generated Dependency-Check
     * report.
     */
<span class="nc" id="L132">    private String reportOutputDirectory = &quot;.&quot;;</span>
    /**
     * Specifies if the build should be failed if a CVSS score above a specified
     * level is identified. The default is 11 which means since the CVSS scores
     * are 0-10, by default the build will never fail and the CVSS score is set
     * to 11. The valid range for the fail build on CVSS is 0 to 11, where
     * anything above 10 will not cause the build to fail.
     */
<span class="nc" id="L140">    private float failBuildOnCVSS = 11;</span>
    /**
     * Sets whether auto-updating of the NVD CVE/CPE data is enabled. It is not
     * recommended that this be turned to false. Default is true.
     */
    private Boolean autoUpdate;
    /**
     * Whether only the update phase should be executed.
     *
     * @deprecated Use the update task instead
     */
<span class="nc" id="L151">    @Deprecated</span>
    private boolean updateOnly = false;

    /**
     * The report format to be generated (HTML, XML, VULN, CSV, JSON, ALL).
     * Default is HTML.
     */
<span class="nc" id="L158">    private String reportFormat = &quot;HTML&quot;;</span>
    /**
     * Suppression file path.
     */
<span class="nc" id="L162">    private String suppressionFile = null;</span>
    /**
     * Suppression file paths.
     */
<span class="nc" id="L166">    @SuppressWarnings(&quot;CanBeFinal&quot;)</span>
    private List&lt;String&gt; suppressionFiles = new ArrayList&lt;&gt;();

    /**
     * The path to the suppression file.
     */
    private String hintsFile;
    /**
     * flag indicating whether or not to show a summary of findings.
     */
<span class="nc" id="L176">    private boolean showSummary = true;</span>
    /**
     * Whether experimental analyzers are enabled.
     */
    private Boolean enableExperimental;
    /**
     * Whether retired analyzers are enabled.
     */
    private Boolean enableRetired;
    /**
     * Whether or not the Jar Analyzer is enabled.
     */
    private Boolean jarAnalyzerEnabled;
    /**
     * Whether or not the Archive Analyzer is enabled.
     */
    private Boolean archiveAnalyzerEnabled;
    /**
     * Whether or not the .NET Nuspec Analyzer is enabled.
     */
    private Boolean nuspecAnalyzerEnabled;
    /**
     * Whether or not the PHP Composer Analyzer is enabled.
     */
    private Boolean composerAnalyzerEnabled;

    /**
     * Whether or not the .NET Assembly Analyzer is enabled.
     */
    private Boolean assemblyAnalyzerEnabled;
    /**
     * Whether the autoconf analyzer should be enabled.
     */
    private Boolean autoconfAnalyzerEnabled;
    /**
     * Sets the path for the bundle-audit binary.
     */
    private String bundleAuditPath;
    /**
     * Whether or not the CocoaPods Analyzer is enabled.
     */
    private Boolean cocoapodsAnalyzerEnabled;

    /**
     * Whether or not the Swift package Analyzer is enabled.
     */
    private Boolean swiftPackageManagerAnalyzerEnabled;
    //The following code was copied Apache Ant PathConvert
    //BEGIN COPY from org.apache.tools.ant.taskdefs.PathConvert
    /**
     * Path to be converted
     */
<span class="nc" id="L228">    private Resources path = null;</span>
    /**
     * Reference to path/file set to convert
     */
<span class="nc" id="L232">    private Reference refId = null;</span>

    /**
     * Add an arbitrary ResourceCollection.
     *
     * @param rc the ResourceCollection to add.
     * @since Ant 1.7
     */
    public void add(ResourceCollection rc) {
<span class="nc bnc" id="L241" title="All 2 branches missed.">        if (isReference()) {</span>
<span class="nc" id="L242">            throw new BuildException(&quot;Nested elements are not allowed when using the refId attribute.&quot;);</span>
        }
<span class="nc" id="L244">        getPath().add(rc);</span>
<span class="nc" id="L245">    }</span>

    /**
     * Add a suppression file.
     *
     * This is called by Ant with the configured {@link SuppressionFile}.
     *
     * @param suppressionFile the suppression file to add.
     */
    public void addConfiguredSuppressionFile(final SuppressionFile suppressionFile) {
<span class="nc" id="L255">        suppressionFiles.add(suppressionFile.getPath());</span>
<span class="nc" id="L256">    }</span>

    /**
     * Returns the path. If the path has not been initialized yet, this class is
     * synchronized, and will instantiate the path object.
     *
     * @return the path
     */
    private synchronized Resources getPath() {
<span class="nc bnc" id="L265" title="All 2 branches missed.">        if (path == null) {</span>
<span class="nc" id="L266">            path = new Resources(getProject());</span>
<span class="nc" id="L267">            path.setCache(true);</span>
        }
<span class="nc" id="L269">        return path;</span>
    }

    /**
     * Learn whether the refId attribute of this element been set.
     *
     * @return true if refId is valid.
     */
    public boolean isReference() {
<span class="nc bnc" id="L278" title="All 2 branches missed.">        return refId != null;</span>
    }

    /**
     * Add a reference to a Path, FileSet, DirSet, or FileList defined
     * elsewhere.
     *
     * @param r the reference to a path, fileset, dirset or filelist.
     */
    public synchronized void setRefId(Reference r) {
<span class="nc bnc" id="L288" title="All 2 branches missed.">        if (path != null) {</span>
<span class="nc" id="L289">            throw new BuildException(&quot;Nested elements are not allowed when using the refId attribute.&quot;);</span>
        }
<span class="nc" id="L291">        refId = r;</span>
<span class="nc" id="L292">    }</span>

    /**
     * If this is a reference, this method will add the referenced resource
     * collection to the collection of paths.
     *
     * @throws BuildException if the reference is not to a resource collection
     */
    private void dealWithReferences() throws BuildException {
<span class="nc bnc" id="L301" title="All 2 branches missed.">        if (isReference()) {</span>
<span class="nc" id="L302">            final Object o = refId.getReferencedObject(getProject());</span>
<span class="nc bnc" id="L303" title="All 2 branches missed.">            if (!(o instanceof ResourceCollection)) {</span>
<span class="nc" id="L304">                throw new BuildException(&quot;refId '&quot; + refId.getRefId()</span>
                        + &quot;' does not refer to a resource collection.&quot;);
            }
<span class="nc" id="L307">            getPath().add((ResourceCollection) o);</span>
        }
<span class="nc" id="L309">    }</span>
    // END COPY from org.apache.tools.ant.taskdefs

    /**
     * Construct a new DependencyCheckTask.
     */
    public Check() {
<span class="nc" id="L316">        super();</span>
        // Call this before Dependency Check Core starts logging anything - this way, all SLF4J messages from
        // core end up coming through this tasks logger
<span class="nc" id="L319">        StaticLoggerBinder.getSingleton().setTask(this);</span>
<span class="nc" id="L320">    }</span>

    /**
     * Get the value of applicationName.
     *
     * @return the value of applicationName
     *
     * @deprecated use projectName instead.
     */
    @Deprecated
    public String getApplicationName() {
<span class="nc" id="L331">        return applicationName;</span>
    }

    /**
     * Set the value of applicationName.
     *
     * @param applicationName new value of applicationName
     * @deprecated use projectName instead.
     */
    @Deprecated
    public void setApplicationName(String applicationName) {
<span class="nc" id="L342">        this.applicationName = applicationName;</span>
<span class="nc" id="L343">    }</span>

    /**
     * Get the value of projectName.
     *
     * @return the value of projectName
     */
    public String getProjectName() {
<span class="nc bnc" id="L351" title="All 2 branches missed.">        if (applicationName != null) {</span>
<span class="nc" id="L352">            log(&quot;Configuration 'applicationName' has been deprecated, please use 'projectName' instead&quot;, Project.MSG_WARN);</span>
<span class="nc bnc" id="L353" title="All 2 branches missed.">            if (&quot;dependency-check&quot;.equals(projectName)) {</span>
<span class="nc" id="L354">                projectName = applicationName;</span>
            }
        }
<span class="nc" id="L357">        return projectName;</span>
    }

    /**
     * Set the value of projectName.
     *
     * @param projectName new value of projectName
     */
    public void setProjectName(String projectName) {
<span class="nc" id="L366">        this.projectName = projectName;</span>
<span class="nc" id="L367">    }</span>

    /**
     * Get the value of reportOutputDirectory.
     *
     * @return the value of reportOutputDirectory
     */
    public String getReportOutputDirectory() {
<span class="nc" id="L375">        return reportOutputDirectory;</span>
    }

    /**
     * Set the value of reportOutputDirectory.
     *
     * @param reportOutputDirectory new value of reportOutputDirectory
     */
    public void setReportOutputDirectory(String reportOutputDirectory) {
<span class="nc" id="L384">        this.reportOutputDirectory = reportOutputDirectory;</span>
<span class="nc" id="L385">    }</span>

    /**
     * Get the value of failBuildOnCVSS.
     *
     * @return the value of failBuildOnCVSS
     */
    public float getFailBuildOnCVSS() {
<span class="nc" id="L393">        return failBuildOnCVSS;</span>
    }

    /**
     * Set the value of failBuildOnCVSS.
     *
     * @param failBuildOnCVSS new value of failBuildOnCVSS
     */
    public void setFailBuildOnCVSS(float failBuildOnCVSS) {
<span class="nc" id="L402">        this.failBuildOnCVSS = failBuildOnCVSS;</span>
<span class="nc" id="L403">    }</span>

    /**
     * Get the value of autoUpdate.
     *
     * @return the value of autoUpdate
     */
    public Boolean isAutoUpdate() {
<span class="nc" id="L411">        return autoUpdate;</span>
    }

    /**
     * Set the value of autoUpdate.
     *
     * @param autoUpdate new value of autoUpdate
     */
    public void setAutoUpdate(Boolean autoUpdate) {
<span class="nc" id="L420">        this.autoUpdate = autoUpdate;</span>
<span class="nc" id="L421">    }</span>

    /**
     * Get the value of updateOnly.
     *
     * @return the value of updateOnly
     * @deprecated Use the update task instead
     */
    @Deprecated
    public boolean isUpdateOnly() {
<span class="nc" id="L431">        return updateOnly;</span>
    }

    /**
     * Set the value of updateOnly.
     *
     * @param updateOnly new value of updateOnly
     * @deprecated Use the update task instead
     */
    @Deprecated
    public void setUpdateOnly(boolean updateOnly) {
<span class="nc" id="L442">        this.updateOnly = updateOnly;</span>
<span class="nc" id="L443">    }</span>

    /**
     * Get the value of reportFormat.
     *
     * @return the value of reportFormat
     */
    public String getReportFormat() {
<span class="nc" id="L451">        return reportFormat;</span>
    }

    /**
     * Set the value of reportFormat.
     *
     * @param reportFormat new value of reportFormat
     */
    public void setReportFormat(ReportFormats reportFormat) {
<span class="nc" id="L460">        this.reportFormat = reportFormat.getValue();</span>
<span class="nc" id="L461">    }</span>

    /**
     * Gets suppression file paths.
     *
     * @return the suppression files.
     */
    public List&lt;String&gt; getSuppressionFiles() {
<span class="nc" id="L469">        return suppressionFiles;</span>
    }

    /**
     * Set the value of suppressionFile.
     *
     * @param suppressionFile new value of suppressionFile
     */
    public void setSuppressionFile(String suppressionFile) {
<span class="nc" id="L478">        this.suppressionFile = suppressionFile;</span>
<span class="nc" id="L479">        suppressionFiles.add(suppressionFile);</span>
<span class="nc" id="L480">    }</span>

    /**
     * Get the value of hintsFile.
     *
     * @return the value of hintsFile
     */
    public String getHintsFile() {
<span class="nc" id="L488">        return hintsFile;</span>
    }

    /**
     * Set the value of hintsFile.
     *
     * @param hintsFile new value of hintsFile
     */
    public void setHintsFile(String hintsFile) {
<span class="nc" id="L497">        this.hintsFile = hintsFile;</span>
<span class="nc" id="L498">    }</span>

    /**
     * Get the value of showSummary.
     *
     * @return the value of showSummary
     */
    public boolean isShowSummary() {
<span class="nc" id="L506">        return showSummary;</span>
    }

    /**
     * Set the value of showSummary.
     *
     * @param showSummary new value of showSummary
     */
    public void setShowSummary(boolean showSummary) {
<span class="nc" id="L515">        this.showSummary = showSummary;</span>
<span class="nc" id="L516">    }</span>

    /**
     * Get the value of enableExperimental.
     *
     * @return the value of enableExperimental
     */
    public Boolean isEnableExperimental() {
<span class="nc" id="L524">        return enableExperimental;</span>
    }

    /**
     * Set the value of enableExperimental.
     *
     * @param enableExperimental new value of enableExperimental
     */
    public void setEnableExperimental(Boolean enableExperimental) {
<span class="nc" id="L533">        this.enableExperimental = enableExperimental;</span>
<span class="nc" id="L534">    }</span>

    /**
     * Get the value of enableRetired.
     *
     * @return the value of enableRetired
     */
    public Boolean isEnableRetired() {
<span class="nc" id="L542">        return enableRetired;</span>
    }

    /**
     * Set the value of enableRetired.
     *
     * @param enableRetired new value of enableRetired
     */
    public void setEnableRetired(Boolean enableRetired) {
<span class="nc" id="L551">        this.enableRetired = enableRetired;</span>
<span class="nc" id="L552">    }</span>

    /**
     * Returns whether or not the analyzer is enabled.
     *
     * @return true if the analyzer is enabled
     */
    public Boolean isJarAnalyzerEnabled() {
<span class="nc" id="L560">        return jarAnalyzerEnabled;</span>
    }

    /**
     * Sets whether or not the analyzer is enabled.
     *
     * @param jarAnalyzerEnabled the value of the new setting
     */
    public void setJarAnalyzerEnabled(Boolean jarAnalyzerEnabled) {
<span class="nc" id="L569">        this.jarAnalyzerEnabled = jarAnalyzerEnabled;</span>
<span class="nc" id="L570">    }</span>

    /**
     * Returns whether or not the analyzer is enabled.
     *
     * @return true if the analyzer is enabled
     */
    public Boolean isArchiveAnalyzerEnabled() {
<span class="nc" id="L578">        return archiveAnalyzerEnabled;</span>
    }

    /**
     * Sets whether or not the analyzer is enabled.
     *
     * @param archiveAnalyzerEnabled the value of the new setting
     */
    public void setArchiveAnalyzerEnabled(Boolean archiveAnalyzerEnabled) {
<span class="nc" id="L587">        this.archiveAnalyzerEnabled = archiveAnalyzerEnabled;</span>
<span class="nc" id="L588">    }</span>

    /**
     * Returns whether or not the analyzer is enabled.
     *
     * @return true if the analyzer is enabled
     */
    public Boolean isAssemblyAnalyzerEnabled() {
<span class="nc" id="L596">        return assemblyAnalyzerEnabled;</span>
    }

    /**
     * Sets whether or not the analyzer is enabled.
     *
     * @param assemblyAnalyzerEnabled the value of the new setting
     */
    public void setAssemblyAnalyzerEnabled(Boolean assemblyAnalyzerEnabled) {
<span class="nc" id="L605">        this.assemblyAnalyzerEnabled = assemblyAnalyzerEnabled;</span>
<span class="nc" id="L606">    }</span>

    /**
     * Returns whether or not the analyzer is enabled.
     *
     * @return true if the analyzer is enabled
     */
    public Boolean isNuspecAnalyzerEnabled() {
<span class="nc" id="L614">        return nuspecAnalyzerEnabled;</span>
    }

    /**
     * Sets whether or not the analyzer is enabled.
     *
     * @param nuspecAnalyzerEnabled the value of the new setting
     */
    public void setNuspecAnalyzerEnabled(Boolean nuspecAnalyzerEnabled) {
<span class="nc" id="L623">        this.nuspecAnalyzerEnabled = nuspecAnalyzerEnabled;</span>
<span class="nc" id="L624">    }</span>

    /**
     * Get the value of composerAnalyzerEnabled.
     *
     * @return the value of composerAnalyzerEnabled
     */
    public Boolean isComposerAnalyzerEnabled() {
<span class="nc" id="L632">        return composerAnalyzerEnabled;</span>
    }

    /**
     * Set the value of composerAnalyzerEnabled.
     *
     * @param composerAnalyzerEnabled new value of composerAnalyzerEnabled
     */
    public void setComposerAnalyzerEnabled(Boolean composerAnalyzerEnabled) {
<span class="nc" id="L641">        this.composerAnalyzerEnabled = composerAnalyzerEnabled;</span>
<span class="nc" id="L642">    }</span>

    /**
     * Get the value of autoconfAnalyzerEnabled.
     *
     * @return the value of autoconfAnalyzerEnabled
     */
    public Boolean isAutoconfAnalyzerEnabled() {
<span class="nc" id="L650">        return autoconfAnalyzerEnabled;</span>
    }

    /**
     * Set the value of autoconfAnalyzerEnabled.
     *
     * @param autoconfAnalyzerEnabled new value of autoconfAnalyzerEnabled
     */
    public void setAutoconfAnalyzerEnabled(Boolean autoconfAnalyzerEnabled) {
<span class="nc" id="L659">        this.autoconfAnalyzerEnabled = autoconfAnalyzerEnabled;</span>
<span class="nc" id="L660">    }</span>

    /**
     * Get the value of cmakeAnalyzerEnabled.
     *
     * @return the value of cmakeAnalyzerEnabled
     */
    public Boolean isCMakeAnalyzerEnabled() {
<span class="nc" id="L668">        return cmakeAnalyzerEnabled;</span>
    }

    /**
     * Set the value of cmakeAnalyzerEnabled.
     *
     * @param cmakeAnalyzerEnabled new value of cmakeAnalyzerEnabled
     */
    public void setCMakeAnalyzerEnabled(Boolean cmakeAnalyzerEnabled) {
<span class="nc" id="L677">        this.cmakeAnalyzerEnabled = cmakeAnalyzerEnabled;</span>
<span class="nc" id="L678">    }</span>

    /**
     * Returns if the Bundle Audit Analyzer is enabled.
     *
     * @return if the Bundle Audit Analyzer is enabled.
     */
    public Boolean isBundleAuditAnalyzerEnabled() {
<span class="nc" id="L686">        return bundleAuditAnalyzerEnabled;</span>
    }

    /**
     * Sets if the Bundle Audit Analyzer is enabled.
     *
     * @param bundleAuditAnalyzerEnabled whether or not the analyzer should be
     * enabled
     */
    public void setBundleAuditAnalyzerEnabled(Boolean bundleAuditAnalyzerEnabled) {
<span class="nc" id="L696">        this.bundleAuditAnalyzerEnabled = bundleAuditAnalyzerEnabled;</span>
<span class="nc" id="L697">    }</span>

    /**
     * Returns the path to the bundle audit executable.
     *
     * @return the path to the bundle audit executable
     */
    public String getBundleAuditPath() {
<span class="nc" id="L705">        return bundleAuditPath;</span>
    }

    /**
     * Sets the path to the bundle audit executable.
     *
     * @param bundleAuditPath the path to the bundle audit executable
     */
    public void setBundleAuditPath(String bundleAuditPath) {
<span class="nc" id="L714">        this.bundleAuditPath = bundleAuditPath;</span>
<span class="nc" id="L715">    }</span>

    /**
     * Returns if the cocoapods analyzer is enabled.
     *
     * @return if the cocoapods analyzer is enabled
     */
    public boolean isCocoapodsAnalyzerEnabled() {
<span class="nc" id="L723">        return cocoapodsAnalyzerEnabled;</span>
    }

    /**
     * Sets whether or not the cocoapods analyzer is enabled.
     *
     * @param cocoapodsAnalyzerEnabled the state of the cocoapods analyzer
     */
    public void setCocoapodsAnalyzerEnabled(Boolean cocoapodsAnalyzerEnabled) {
<span class="nc" id="L732">        this.cocoapodsAnalyzerEnabled = cocoapodsAnalyzerEnabled;</span>
<span class="nc" id="L733">    }</span>

    /**
     * Returns whether or not the Swift package Analyzer is enabled.
     *
     * @return whether or not the Swift package Analyzer is enabled
     */
    public Boolean isSwiftPackageManagerAnalyzerEnabled() {
<span class="nc" id="L741">        return swiftPackageManagerAnalyzerEnabled;</span>
    }

    /**
     * Sets the enabled state of the swift package manager analyzer.
     *
     * @param swiftPackageManagerAnalyzerEnabled the enabled state of the swift
     * package manager
     */
    public void setSwiftPackageManagerAnalyzerEnabled(Boolean swiftPackageManagerAnalyzerEnabled) {
<span class="nc" id="L751">        this.swiftPackageManagerAnalyzerEnabled = swiftPackageManagerAnalyzerEnabled;</span>
<span class="nc" id="L752">    }</span>

    /**
     * Get the value of opensslAnalyzerEnabled.
     *
     * @return the value of opensslAnalyzerEnabled
     */
    public Boolean isOpensslAnalyzerEnabled() {
<span class="nc" id="L760">        return opensslAnalyzerEnabled;</span>
    }

    /**
     * Set the value of opensslAnalyzerEnabled.
     *
     * @param opensslAnalyzerEnabled new value of opensslAnalyzerEnabled
     */
    public void setOpensslAnalyzerEnabled(Boolean opensslAnalyzerEnabled) {
<span class="nc" id="L769">        this.opensslAnalyzerEnabled = opensslAnalyzerEnabled;</span>
<span class="nc" id="L770">    }</span>

    /**
     * Get the value of nodeAnalyzerEnabled.
     *
     * @return the value of nodeAnalyzerEnabled
     */
    public Boolean isNodeAnalyzerEnabled() {
<span class="nc" id="L778">        return nodeAnalyzerEnabled;</span>
    }

    /**
     * Set the value of nodeAnalyzerEnabled.
     *
     * @param nodeAnalyzerEnabled new value of nodeAnalyzerEnabled
     */
    public void setNodeAnalyzerEnabled(Boolean nodeAnalyzerEnabled) {
<span class="nc" id="L787">        this.nodeAnalyzerEnabled = nodeAnalyzerEnabled;</span>
<span class="nc" id="L788">    }</span>

    /**
     * Get the value of nspAnalyzerEnabled.
     *
     * @return the value of nspAnalyzerEnabled
     */
    public Boolean isNspAnalyzerEnabled() {
<span class="nc" id="L796">        return nspAnalyzerEnabled;</span>
    }

    /**
     * Set the value of nspAnalyzerEnabled.
     *
     * @param nspAnalyzerEnabled new value of nspAnalyzerEnabled
     */
    public void setNspAnalyzerEnabled(Boolean nspAnalyzerEnabled) {
<span class="nc" id="L805">        this.nspAnalyzerEnabled = nspAnalyzerEnabled;</span>
<span class="nc" id="L806">    }</span>

    /**
     * Get the value of rubygemsAnalyzerEnabled.
     *
     * @return the value of rubygemsAnalyzerEnabled
     */
    public Boolean isRubygemsAnalyzerEnabled() {
<span class="nc" id="L814">        return rubygemsAnalyzerEnabled;</span>
    }

    /**
     * Set the value of rubygemsAnalyzerEnabled.
     *
     * @param rubygemsAnalyzerEnabled new value of rubygemsAnalyzerEnabled
     */
    public void setRubygemsAnalyzerEnabled(Boolean rubygemsAnalyzerEnabled) {
<span class="nc" id="L823">        this.rubygemsAnalyzerEnabled = rubygemsAnalyzerEnabled;</span>
<span class="nc" id="L824">    }</span>

    /**
     * Get the value of pyPackageAnalyzerEnabled.
     *
     * @return the value of pyPackageAnalyzerEnabled
     */
    public Boolean isPyPackageAnalyzerEnabled() {
<span class="nc" id="L832">        return pyPackageAnalyzerEnabled;</span>
    }

    /**
     * Set the value of pyPackageAnalyzerEnabled.
     *
     * @param pyPackageAnalyzerEnabled new value of pyPackageAnalyzerEnabled
     */
    public void setPyPackageAnalyzerEnabled(Boolean pyPackageAnalyzerEnabled) {
<span class="nc" id="L841">        this.pyPackageAnalyzerEnabled = pyPackageAnalyzerEnabled;</span>
<span class="nc" id="L842">    }</span>

    /**
     * Get the value of pyDistributionAnalyzerEnabled.
     *
     * @return the value of pyDistributionAnalyzerEnabled
     */
    public Boolean isPyDistributionAnalyzerEnabled() {
<span class="nc" id="L850">        return pyDistributionAnalyzerEnabled;</span>
    }

    /**
     * Set the value of pyDistributionAnalyzerEnabled.
     *
     * @param pyDistributionAnalyzerEnabled new value of
     * pyDistributionAnalyzerEnabled
     */
    public void setPyDistributionAnalyzerEnabled(Boolean pyDistributionAnalyzerEnabled) {
<span class="nc" id="L860">        this.pyDistributionAnalyzerEnabled = pyDistributionAnalyzerEnabled;</span>
<span class="nc" id="L861">    }</span>

    /**
     * Get the value of centralAnalyzerEnabled.
     *
     * @return the value of centralAnalyzerEnabled
     */
    public Boolean isCentralAnalyzerEnabled() {
<span class="nc" id="L869">        return centralAnalyzerEnabled;</span>
    }

    /**
     * Set the value of centralAnalyzerEnabled.
     *
     * @param centralAnalyzerEnabled new value of centralAnalyzerEnabled
     */
    public void setCentralAnalyzerEnabled(Boolean centralAnalyzerEnabled) {
<span class="nc" id="L878">        this.centralAnalyzerEnabled = centralAnalyzerEnabled;</span>
<span class="nc" id="L879">    }</span>

    /**
     * Get the value of nexusAnalyzerEnabled.
     *
     * @return the value of nexusAnalyzerEnabled
     */
    public Boolean isNexusAnalyzerEnabled() {
<span class="nc" id="L887">        return nexusAnalyzerEnabled;</span>
    }

    /**
     * Set the value of nexusAnalyzerEnabled.
     *
     * @param nexusAnalyzerEnabled new value of nexusAnalyzerEnabled
     */
    public void setNexusAnalyzerEnabled(Boolean nexusAnalyzerEnabled) {
<span class="nc" id="L896">        this.nexusAnalyzerEnabled = nexusAnalyzerEnabled;</span>
<span class="nc" id="L897">    }</span>

    /**
     * Get the value of nexusUrl.
     *
     * @return the value of nexusUrl
     */
    public String getNexusUrl() {
<span class="nc" id="L905">        return nexusUrl;</span>
    }

    /**
     * Set the value of nexusUrl.
     *
     * @param nexusUrl new value of nexusUrl
     */
    public void setNexusUrl(String nexusUrl) {
<span class="nc" id="L914">        this.nexusUrl = nexusUrl;</span>
<span class="nc" id="L915">    }</span>

    /**
     * Get the value of nexusUsesProxy.
     *
     * @return the value of nexusUsesProxy
     */
    public Boolean isNexusUsesProxy() {
<span class="nc" id="L923">        return nexusUsesProxy;</span>
    }

    /**
     * Set the value of nexusUsesProxy.
     *
     * @param nexusUsesProxy new value of nexusUsesProxy
     */
    public void setNexusUsesProxy(Boolean nexusUsesProxy) {
<span class="nc" id="L932">        this.nexusUsesProxy = nexusUsesProxy;</span>
<span class="nc" id="L933">    }</span>

    /**
     * Get the value of zipExtensions.
     *
     * @return the value of zipExtensions
     */
    public String getZipExtensions() {
<span class="nc" id="L941">        return zipExtensions;</span>
    }

    /**
     * Set the value of zipExtensions.
     *
     * @param zipExtensions new value of zipExtensions
     */
    public void setZipExtensions(String zipExtensions) {
<span class="nc" id="L950">        this.zipExtensions = zipExtensions;</span>
<span class="nc" id="L951">    }</span>

    /**
     * Get the value of pathToMono.
     *
     * @return the value of pathToMono
     */
    public String getPathToMono() {
<span class="nc" id="L959">        return pathToMono;</span>
    }

    /**
     * Set the value of pathToMono.
     *
     * @param pathToMono new value of pathToMono
     */
    public void setPathToMono(String pathToMono) {
<span class="nc" id="L968">        this.pathToMono = pathToMono;</span>
<span class="nc" id="L969">    }</span>

    @Override
    public void execute() throws BuildException {
<span class="nc" id="L973">        dealWithReferences();</span>
<span class="nc" id="L974">        validateConfiguration();</span>
<span class="nc" id="L975">        populateSettings();</span>
<span class="nc" id="L976">        try (Engine engine = new Engine(Check.class.getClassLoader(), getSettings())) {</span>
<span class="nc bnc" id="L977" title="All 2 branches missed.">            if (isUpdateOnly()) {</span>
<span class="nc" id="L978">                log(&quot;Deprecated 'UpdateOnly' property set; please use the UpdateTask instead&quot;, Project.MSG_WARN);</span>
                try {
<span class="nc" id="L980">                    engine.doUpdates();</span>
<span class="nc" id="L981">                } catch (UpdateException ex) {</span>
<span class="nc bnc" id="L982" title="All 2 branches missed.">                    if (this.isFailOnError()) {</span>
<span class="nc" id="L983">                        throw new BuildException(ex);</span>
                    }
<span class="nc" id="L985">                    log(ex.getMessage(), Project.MSG_ERR);</span>
<span class="nc" id="L986">                }</span>
            } else {
<span class="nc bnc" id="L988" title="All 2 branches missed.">                for (Resource resource : getPath()) {</span>
<span class="nc" id="L989">                    final FileProvider provider = resource.as(FileProvider.class);</span>
<span class="nc bnc" id="L990" title="All 2 branches missed.">                    if (provider != null) {</span>
<span class="nc" id="L991">                        final File file = provider.getFile();</span>
<span class="nc bnc" id="L992" title="All 4 branches missed.">                        if (file != null &amp;&amp; file.exists()) {</span>
<span class="nc" id="L993">                            engine.scan(file);</span>
                        }
                    }
<span class="nc" id="L996">                }</span>

                try {
<span class="nc" id="L999">                    engine.analyzeDependencies();</span>
<span class="nc" id="L1000">                } catch (ExceptionCollection ex) {</span>
<span class="nc bnc" id="L1001" title="All 2 branches missed.">                    if (this.isFailOnError()) {</span>
<span class="nc" id="L1002">                        throw new BuildException(ex);</span>
                    }
<span class="nc" id="L1004">                }</span>
<span class="nc" id="L1005">                engine.writeReports(getProjectName(), new File(reportOutputDirectory), reportFormat);</span>

<span class="nc bnc" id="L1007" title="All 2 branches missed.">                if (this.failBuildOnCVSS &lt;= 10) {</span>
<span class="nc" id="L1008">                    checkForFailure(engine.getDependencies());</span>
                }
<span class="nc bnc" id="L1010" title="All 2 branches missed.">                if (this.showSummary) {</span>
<span class="nc" id="L1011">                    showSummary(engine.getDependencies());</span>
                }
            }
<span class="nc bnc" id="L1014" title="All 8 branches missed.">        } catch (DatabaseException ex) {</span>
<span class="nc" id="L1015">            final String msg = &quot;Unable to connect to the dependency-check database; analysis has stopped&quot;;</span>
<span class="nc bnc" id="L1016" title="All 2 branches missed.">            if (this.isFailOnError()) {</span>
<span class="nc" id="L1017">                throw new BuildException(msg, ex);</span>
            }
<span class="nc" id="L1019">            log(msg, ex, Project.MSG_ERR);</span>
<span class="nc" id="L1020">        } catch (ReportException ex) {</span>
<span class="nc" id="L1021">            final String msg = &quot;Unable to generate the dependency-check report&quot;;</span>
<span class="nc bnc" id="L1022" title="All 2 branches missed.">            if (this.isFailOnError()) {</span>
<span class="nc" id="L1023">                throw new BuildException(msg, ex);</span>
            }
<span class="nc" id="L1025">            log(msg, ex, Project.MSG_ERR);</span>
        } finally {
<span class="nc" id="L1027">            getSettings().cleanup();</span>
<span class="nc" id="L1028">        }</span>
<span class="nc" id="L1029">    }</span>

    /**
     * Validate the configuration to ensure the parameters have been properly
     * configured/initialized.
     *
     * @throws BuildException if the task was not configured correctly.
     */
    private synchronized void validateConfiguration() throws BuildException {
<span class="nc bnc" id="L1038" title="All 2 branches missed.">        if (path == null) {</span>
<span class="nc" id="L1039">            throw new BuildException(&quot;No project dependencies have been defined to analyze.&quot;);</span>
        }
<span class="nc bnc" id="L1041" title="All 4 branches missed.">        if (failBuildOnCVSS &lt; 0 || failBuildOnCVSS &gt; 11) {</span>
<span class="nc" id="L1042">            throw new BuildException(&quot;Invalid configuration, failBuildOnCVSS must be between 0 and 11.&quot;);</span>
        }
<span class="nc" id="L1044">    }</span>

    /**
     * Takes the properties supplied and updates the dependency-check settings.
     * Additionally, this sets the system properties required to change the
     * proxy server, port, and connection timeout.
     *
     * @throws BuildException thrown when an invalid setting is configured.
     */
    @Override
    protected void populateSettings() throws BuildException {
<span class="nc" id="L1055">        super.populateSettings();</span>
<span class="nc" id="L1056">        getSettings().setBooleanIfNotNull(Settings.KEYS.AUTO_UPDATE, autoUpdate);</span>
<span class="nc" id="L1057">        getSettings().setArrayIfNotEmpty(Settings.KEYS.SUPPRESSION_FILE, suppressionFiles.toArray(new String[suppressionFiles.size()]));</span>
<span class="nc" id="L1058">        getSettings().setStringIfNotEmpty(Settings.KEYS.HINTS_FILE, hintsFile);</span>
<span class="nc" id="L1059">        getSettings().setBooleanIfNotNull(Settings.KEYS.ANALYZER_EXPERIMENTAL_ENABLED, enableExperimental);</span>
<span class="nc" id="L1060">        getSettings().setBooleanIfNotNull(Settings.KEYS.ANALYZER_RETIRED_ENABLED, enableRetired);</span>
<span class="nc" id="L1061">        getSettings().setBooleanIfNotNull(Settings.KEYS.ANALYZER_JAR_ENABLED, jarAnalyzerEnabled);</span>
<span class="nc" id="L1062">        getSettings().setBooleanIfNotNull(Settings.KEYS.ANALYZER_PYTHON_DISTRIBUTION_ENABLED, pyDistributionAnalyzerEnabled);</span>
<span class="nc" id="L1063">        getSettings().setBooleanIfNotNull(Settings.KEYS.ANALYZER_PYTHON_PACKAGE_ENABLED, pyPackageAnalyzerEnabled);</span>
<span class="nc" id="L1064">        getSettings().setBooleanIfNotNull(Settings.KEYS.ANALYZER_RUBY_GEMSPEC_ENABLED, rubygemsAnalyzerEnabled);</span>
<span class="nc" id="L1065">        getSettings().setBooleanIfNotNull(Settings.KEYS.ANALYZER_OPENSSL_ENABLED, opensslAnalyzerEnabled);</span>
<span class="nc" id="L1066">        getSettings().setBooleanIfNotNull(Settings.KEYS.ANALYZER_CMAKE_ENABLED, cmakeAnalyzerEnabled);</span>
<span class="nc" id="L1067">        getSettings().setBooleanIfNotNull(Settings.KEYS.ANALYZER_SWIFT_PACKAGE_MANAGER_ENABLED, swiftPackageManagerAnalyzerEnabled);</span>
<span class="nc" id="L1068">        getSettings().setBooleanIfNotNull(Settings.KEYS.ANALYZER_COCOAPODS_ENABLED, cocoapodsAnalyzerEnabled);</span>
<span class="nc" id="L1069">        getSettings().setBooleanIfNotNull(Settings.KEYS.ANALYZER_BUNDLE_AUDIT_ENABLED, bundleAuditAnalyzerEnabled);</span>
<span class="nc" id="L1070">        getSettings().setStringIfNotNull(Settings.KEYS.ANALYZER_BUNDLE_AUDIT_PATH, bundleAuditPath);</span>
<span class="nc" id="L1071">        getSettings().setBooleanIfNotNull(Settings.KEYS.ANALYZER_AUTOCONF_ENABLED, autoconfAnalyzerEnabled);</span>
<span class="nc" id="L1072">        getSettings().setBooleanIfNotNull(Settings.KEYS.ANALYZER_COMPOSER_LOCK_ENABLED, composerAnalyzerEnabled);</span>
<span class="nc" id="L1073">        getSettings().setBooleanIfNotNull(Settings.KEYS.ANALYZER_NODE_PACKAGE_ENABLED, nodeAnalyzerEnabled);</span>
<span class="nc" id="L1074">        getSettings().setBooleanIfNotNull(Settings.KEYS.ANALYZER_NSP_PACKAGE_ENABLED, nspAnalyzerEnabled);</span>
<span class="nc" id="L1075">        getSettings().setBooleanIfNotNull(Settings.KEYS.ANALYZER_NUSPEC_ENABLED, nuspecAnalyzerEnabled);</span>
<span class="nc" id="L1076">        getSettings().setBooleanIfNotNull(Settings.KEYS.ANALYZER_CENTRAL_ENABLED, centralAnalyzerEnabled);</span>
<span class="nc" id="L1077">        getSettings().setBooleanIfNotNull(Settings.KEYS.ANALYZER_NEXUS_ENABLED, nexusAnalyzerEnabled);</span>
<span class="nc" id="L1078">        getSettings().setBooleanIfNotNull(Settings.KEYS.ANALYZER_ARCHIVE_ENABLED, archiveAnalyzerEnabled);</span>
<span class="nc" id="L1079">        getSettings().setBooleanIfNotNull(Settings.KEYS.ANALYZER_ASSEMBLY_ENABLED, assemblyAnalyzerEnabled);</span>
<span class="nc" id="L1080">        getSettings().setStringIfNotEmpty(Settings.KEYS.ANALYZER_NEXUS_URL, nexusUrl);</span>
<span class="nc" id="L1081">        getSettings().setBooleanIfNotNull(Settings.KEYS.ANALYZER_NEXUS_USES_PROXY, nexusUsesProxy);</span>
<span class="nc" id="L1082">        getSettings().setStringIfNotEmpty(Settings.KEYS.ADDITIONAL_ZIP_EXTENSIONS, zipExtensions);</span>
<span class="nc" id="L1083">        getSettings().setStringIfNotEmpty(Settings.KEYS.ANALYZER_ASSEMBLY_MONO_PATH, pathToMono);</span>
<span class="nc" id="L1084">    }</span>

    /**
     * Checks to see if a vulnerability has been identified with a CVSS score
     * that is above the threshold set in the configuration.
     *
     * @param dependencies the list of dependency objects
     * @throws BuildException thrown if a CVSS score is found that is higher
     * than the threshold set
     */
    private void checkForFailure(Dependency[] dependencies) throws BuildException {
<span class="nc" id="L1095">        final StringBuilder ids = new StringBuilder();</span>
<span class="nc bnc" id="L1096" title="All 2 branches missed.">        for (Dependency d : dependencies) {</span>
<span class="nc bnc" id="L1097" title="All 2 branches missed.">            for (Vulnerability v : d.getVulnerabilities()) {</span>
<span class="nc bnc" id="L1098" title="All 2 branches missed.">                if (v.getCvssScore() &gt;= failBuildOnCVSS) {</span>
<span class="nc bnc" id="L1099" title="All 2 branches missed.">                    if (ids.length() == 0) {</span>
<span class="nc" id="L1100">                        ids.append(v.getName());</span>
                    } else {
<span class="nc" id="L1102">                        ids.append(&quot;, &quot;).append(v.getName());</span>
                    }
                }
<span class="nc" id="L1105">            }</span>
        }
<span class="nc bnc" id="L1107" title="All 2 branches missed.">        if (ids.length() &gt; 0) {</span>
            final String msg;
<span class="nc bnc" id="L1109" title="All 2 branches missed.">            if (showSummary) {</span>
<span class="nc" id="L1110">                msg = String.format(&quot;%n%nDependency-Check Failure:%n&quot;</span>
                        + &quot;One or more dependencies were identified with vulnerabilities that have a CVSS score greater than or equal to '%.1f': %s%n&quot;
                        + &quot;See the dependency-check report for more details.%n%n&quot;, failBuildOnCVSS, ids.toString());
            } else {
<span class="nc" id="L1114">                msg = String.format(&quot;%n%nDependency-Check Failure:%n&quot;</span>
                        + &quot;One or more dependencies were identified with vulnerabilities.%n%n&quot;
                        + &quot;See the dependency-check report for more details.%n%n&quot;);
            }
<span class="nc" id="L1118">            throw new BuildException(msg);</span>
        }
<span class="nc" id="L1120">    }</span>

    /**
     * Generates a warning message listing a summary of dependencies and their
     * associated CPE and CVE entries.
     *
     * @param dependencies a list of dependency objects
     */
    private void showSummary(Dependency[] dependencies) {
<span class="nc" id="L1129">        final StringBuilder summary = new StringBuilder();</span>
<span class="nc bnc" id="L1130" title="All 2 branches missed.">        for (Dependency d : dependencies) {</span>
<span class="nc" id="L1131">            boolean firstEntry = true;</span>
<span class="nc" id="L1132">            final StringBuilder ids = new StringBuilder();</span>
<span class="nc bnc" id="L1133" title="All 2 branches missed.">            for (Vulnerability v : d.getVulnerabilities(true)) {</span>
<span class="nc bnc" id="L1134" title="All 2 branches missed.">                if (firstEntry) {</span>
<span class="nc" id="L1135">                    firstEntry = false;</span>
                } else {
<span class="nc" id="L1137">                    ids.append(&quot;, &quot;);</span>
                }
<span class="nc" id="L1139">                ids.append(v.getName());</span>
<span class="nc" id="L1140">            }</span>
<span class="nc bnc" id="L1141" title="All 2 branches missed.">            if (ids.length() &gt; 0) {</span>
<span class="nc" id="L1142">                summary.append(d.getFileName()).append(&quot; (&quot;);</span>
<span class="nc" id="L1143">                firstEntry = true;</span>
<span class="nc bnc" id="L1144" title="All 2 branches missed.">                for (Identifier id : d.getIdentifiers()) {</span>
<span class="nc bnc" id="L1145" title="All 2 branches missed.">                    if (firstEntry) {</span>
<span class="nc" id="L1146">                        firstEntry = false;</span>
                    } else {
<span class="nc" id="L1148">                        summary.append(&quot;, &quot;);</span>
                    }
<span class="nc" id="L1150">                    summary.append(id.getValue());</span>
<span class="nc" id="L1151">                }</span>
<span class="nc" id="L1152">                summary.append(&quot;) : &quot;).append(ids).append(NEW_LINE);</span>
            }
        }
<span class="nc bnc" id="L1155" title="All 2 branches missed.">        if (summary.length() &gt; 0) {</span>
<span class="nc" id="L1156">            final String msg = String.format(&quot;%n%n&quot;</span>
                    + &quot;One or more dependencies were identified with known vulnerabilities:%n%n%s&quot;
                    + &quot;%n%nSee the dependency-check report for more details.%n%n&quot;, summary.toString());
<span class="nc" id="L1159">            log(msg, Project.MSG_WARN);</span>
        }
<span class="nc" id="L1161">    }</span>

    /**
     * An enumeration of supported report formats: &quot;ALL&quot;, &quot;HTML&quot;, &quot;XML&quot;, &quot;CSV&quot;,
     * &quot;JSON&quot;, &quot;VULN&quot;, etc..
     */
<span class="nc" id="L1167">    public static class ReportFormats extends EnumeratedAttribute {</span>

        /**
         * Returns the list of values for the report format.
         *
         * @return the list of values for the report format
         */
        @Override
        public String[] getValues() {
<span class="nc" id="L1176">            int i = 0;</span>
<span class="nc" id="L1177">            final Format[] formats = Format.values();</span>
<span class="nc" id="L1178">            final String[] values = new String[formats.length];</span>
<span class="nc bnc" id="L1179" title="All 2 branches missed.">            for (Format format : formats) {</span>
<span class="nc" id="L1180">                values[i++] = format.name();</span>
            }
<span class="nc" id="L1182">            return values;</span>
        }
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.7.9.201702052155</span></div></body></html>